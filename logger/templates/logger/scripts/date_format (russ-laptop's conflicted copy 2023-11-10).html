<script>


function reset_datatime(){
    var today = new Date();
    var year = today.getFullYear();
    var month = today.getMonth() + 1;
    month = month < 10 ? '0'+month : month;
    var day = today.getDate();
    day = day < 10 ? '0'+day : day;
    var hour = today.getHours();
    hour = hour < 10 ? '0'+hour : hour;
    var minute = today.getMinutes();
    minute = minute < 10 ? '0' + minute : minute;
    var second = today.getSeconds();
    second = second < 10 ? '0' + second : second;
    var formattedDate = year + '-' + month +'-'+ day +' '+hour+':'+minute+':'+second;
    document.getElementById('id_datetime').value = formattedDate;
}

function date_format(id) {
    var dt2= document.getElementById(id).value;
    var dt = dt2.replace(/\D/g,''); // remove non num
    var formattedText = '';
    if(dt.length < 5){
         formattedText = dt;
    }
    if(dt.length < 7 & dt.length >= 5){
         formattedText  = dt.slice(0,4) + '-' + dt.slice(4,6);
    }
    if(dt.length >= 7){
        formattedText  = dt.slice(0,4) + '-' + dt.slice(4,6)+'-'+dt.slice(6,8);
    }

    document.getElementById(id).value = formattedText ;
}

function add_reset_button(){
    
    var a = document.createElement('div');
    var linkText = document.createTextNode("  reset time");
    a.appendChild(linkText);
    a.title = "today";
    a.id = "reset_datetime";
    a.onclick= reset_datatime;
    a.style.marginBottom = '5px';
    a.style.marginRight = '4px';
    a.style.marginLeft = '4px';
    a.style.paddingLeft = '12px';
    a.style.border = '1px solid #cccccc';
    a.style.maxWidth = '110px';
    a.style.borderRadius = "25px"; 
    a.style.color = 'rgb(73, 80, 87)';
    a.style.backgroundColor = '#e6e6e6';
    document.getElementById('id_datetime').parentElement.prepend(a);
}

document.addEventListener("DOMContentLoaded", () => {
  console.log("Loaded: date_format.html");
    var inputs = [ 'dob'] ;
    inputs.map(function (label){
         var id = 'id_'+label;
         try{
             document.getElementById(id).onchange = function(){ date_format(id)};
             document.getElementById(id).onkeyup = function(){ date_format(id)};
         }catch(err){
             console.log(err);
            }
     });
});


</script>
