<script>


function reset_datatime(){
    var today = new Date();
    var year = today.getFullYear();
    var month = today.getMonth() + 1;
    month = month < 10 ? '0'+month : month;
    var day = today.getDate();
    day = day < 10 ? '0'+day : day;
    var hour = today.getHours();
    hour = hour < 10 ? '0'+hour : hour;
    var minute = today.getMinutes();
    minute = minute < 10 ? '0' + minute : minute;
    var second = today.getSeconds();
    second = second < 10 ? '0' + second : second;
    var formattedDate = year + '-' + month +'-'+ day +' '+hour+':'+minute+':'+second;
    document.getElementById('id_date').value = formattedDate;
}

function datetime_format() {
    var dt2= document.getElementById('id_date').value;
    var dt = dt2.replace(/\D/g,'');
    var formattedText = '';
    if(dt.length < 5){
         formattedText = dt;
    }
    if(dt.length < 7 & dt.length >= 5){
         formattedText  = dt.slice(0,4) + '-' + dt.slice(4,6);
    }
    if(dt.length < 9 & dt.length >= 7){
        formattedText  = dt.slice(0,4) + '-' + dt.slice(4,6)+'-'+dt.slice(6,8);
    }
    if(dt.length <11 & dt.length >= 9){
        formattedText  = dt.slice(0,4) + '-' + dt.slice(4,6)+'-'+dt.slice(6,8)+' '+dt.slice(8,10);
    }
    if( dt.length >= 11){
        formattedText  =dt.slice(0,4) + '-' + dt.slice(4,6)+'-'+dt.slice(6,8)+' '+dt.slice(8,10)+':'+dt.slice(10,12);
    }
    document.getElementById('id_date').value = formattedText ;
}

function add_reset_button(){
    
    var a = document.createElement('div');
    var linkText = document.createTextNode("  reset time");
    a.appendChild(linkText);
    a.title = "today";
    a.id = "reset_datetime";
    a.onclick= reset_datatime;
    a.style.marginBottom = '5px';
    a.style.marginRight = '4px';
    a.style.marginLeft = '4px';
    a.style.paddingLeft = '12px';
    a.style.border = '1px solid #cccccc';
    a.style.maxWidth = '110px';
    a.style.borderRadius = "25px"; 
    a.style.color = 'rgb(73, 80, 87)';
    a.style.backgroundColor = '#e6e6e6';
    document.getElementById('id_date').parentElement.prepend(a);
}

function update_time(){
     if(document.getElementById('time-active').checked) {
        console.log('active');
        reset_datatime();
        }else{
            console.log('disabled')
        }
    }
        

document.addEventListener("DOMContentLoaded", () => {
  console.log("Loaded: datetime_formate.html");
    document.getElementById('id_date').onchange = datetime_format;
    document.getElementById('id_date').onkeyup = datetime_format;

    // add_reset_button();
     
     setInterval(update_time, 1000);

});
</script>
